<!doctype html>

<html>

  <head>
    <meta http-equiv='content-type' content='text/html; charset=utf-8'>
    <meta name="viewport" content="width=device-width, user-scalable=0">
    <title>Chartabull Demo - Lines</title>
    <link rel='stylesheet' href='chartabull.css'>
    <script src='bower_components/jquery/dist/jquery.js'></script>
    <script src='bower_components/underscore/underscore.js'></script>
    <script src='chartabull.js'></script>
    <style>
      body{
        font-family: 'helvetica neue', arial, helvetica, verdana, sans-serif;
        text-align: center;
        color: #333;
        font-weight: 300;
        font-size: 18px;
      }
      .chart{
        margin-bottom: 3em;
      }
      canvas{
        border-radius: 5px;
      }
    </style>
  </head>

  <body>
    <h1>The Line Chart</h1>
    <p>Takes an array of values and graphs them in the simplest way possible. The last value is the value shown in the graph.</p>
    <div class="chart">
      <canvas height="150" width="300" class="js-chartabull"
          data-values="[1,3,4,5,17]"
          data-options='{}'
          data-text="Members"></canvas>
    </div>
    <p>Size, fonts, and colors can be customized.</p>
    <div class="chart">
      <canvas height="250" width="500" class="js-chartabull"
          data-values="[25,15,25,3,35]"
          data-options='{"backgroundColor": "#E97F02", "chartColor": "#F8CA00", "textColor": "#490A3D"}'
          data-text="% Retention Rate"></canvas>
    </div>

    <p>Send me lots of numbers.</p>

    <div class="chart">
      <canvas height="250" width="500" class="js-chartabull"
          data-values="[942, 76, 335, 382, 527, 102, 832, 244, 214, 947, 379, 114, 239, 155, 108, 4, 600, 279, 929, 269, 824, 15, 354, 900, 860, 586, 262, 957, 232, 721, 49, 344, 141, 978, 76, 686, 645, 878, 796, 947, 531, 579, 840, 865, 929, 263, 853, 783, 146, 386, 669, 609, 157, 248, 420, 589, 391, 875, 745, 236, 123, 512, 605, 823, 594, 213, 205, 373, 345, 917, 906, 315, 308, 23, 171, 663, 630, 47, 143, 270, 421, 729, 224, 69, 392, 93, 870, 343, 15, 531, 331, 310, 95, 495, 862, 808, 284, 486, 741, 642,942, 76, 335, 382, 527, 102, 832, 244, 214, 947, 379, 114, 239, 155, 108, 4, 600, 279, 929, 269, 824, 15, 354, 900, 860, 586, 262, 957, 232, 721, 49, 344, 141, 978, 76, 686, 645, 878, 796, 947, 531, 579, 840, 865, 929, 263, 853, 783, 146, 386, 669, 609, 157, 248, 420, 589, 391, 875, 745, 236, 123, 512, 605, 823, 594, 213, 205, 373, 345, 917, 906, 315, 308, 23, 171, 663, 630, 47, 143, 270, 421, 729, 224, 69, 392, 93, 870, 343, 15, 531, 331, 310, 95, 495, 862, 808, 284, 486, 741, 642,942, 76, 335, 382, 527, 102, 832, 244, 214, 947, 379, 114, 239, 155, 108, 4, 600, 279, 929, 269, 824, 15, 354, 900, 860, 586, 262, 957, 232, 721, 49, 344, 141, 978, 76, 686, 645, 878, 796, 947, 531, 579, 840, 865, 929, 263, 853, 783, 146, 386, 669, 609, 157, 248, 420, 589, 391, 875, 745, 236, 123, 512, 605, 823, 594, 213, 205, 373, 345, 917, 906, 315, 308, 23, 171, 663, 630, 47, 143, 270, 421, 729, 224, 69, 392, 93, 870, 343, 15, 531, 331, 310, 95, 495, 862, 808, 284, 486, 741, 642]"
          data-options=''
          data-text="Of Something"></canvas>
    </div>
    <!--
    <div class="chart">
      <canvas height="150" width="500" class="js-chartabull"
          data-values="[942, 76, 335, 382, 527, 102, 832, 244, 214, 947, 531, 331, 310, 95, 495, 862, 808, 284, 486, 741, 12]"
          data-options='{"backgroundColor": "#BD1550", "chartColor": "#c7386a", "textColor": "#fff", "largeFont": "100 50px \"helvetica neue\"", "smallFont": "100 25px \"helvetica neue\""}'
          data-text="is my favorite number"></canvas>
    -->
    </div>
  </body>

</html>



<script>
  (function () {
    'use strict';
    // Store a local reference to jQuery and Underscore.
    var $ = window.jQuery;
    var _ = window._;

    var Chartabull = window.Chartabull = function(el, data, options, chartText){
      _.extend(this, options);
      this.buildChart(el, data).buildText(el, data, chartText);
    }

    _.extend(Chartabull.prototype, {
      // Color for area fill
      chartColor: '#eee;',

      // Font Stylings used in text laid on top
      textColor: '#aaa;',
      textPadding: 20,
      smallFont: "normal 24px 'helvetica neue', arial, verdana, sans-serif",
      largeFont: "bold 50px 'helvetica neue', arial, verdana, sans-serif",

      // Background of Chart
      backgroundColor: "#fff",

      // Drop some text on the graph
      buildText: function(el, data, chartText){
        var height = el.height(),
            width = el.width();

        var context = el[0].getContext("2d");

        context.fillStyle = this.textColor;
        context.font = this.largeFont;
        context.fillText(data[_.size(data)-1], this.textPadding, height-50);
        context.font = this.smallFont;
        context.fillText(chartText, this.textPadding, height-this.textPadding);

        return this;
      },
      // Draw the chart itself
      buildChart: function(el,data){
        var height = el.height(),
            width = el.width(),
            dataSize = _.size(data),
            max = _.max(data),
            min = _.min(data),
            segmentWidth = width/(dataSize-1),
            segmentHeight = height/max;

        var drawContext = el[0].getContext("2d");

        // Fill the background
        drawContext.fillStyle = this.backgroundColor;
        drawContext.fillRect(0,0, width, height);

        // Begin our path at the bottom left of the chart area
        drawContext.beginPath();
        drawContext.moveTo(0, height);

        $.each(data, function(val){
          var current_x = val * segmentWidth;
          var current_y = (height) - (data[val] * segmentHeight);
          drawContext.lineTo(current_x, current_y);
        });

        // Close out the graph (connect to bottom right)
        drawContext.lineTo(width, height);
        drawContext.closePath();

        // Apply optional styles
        drawContext.fillStyle = this.chartColor;
        drawContext.fill();

        return this;
      }
    });

    $('.js-chartabull').each(function () {
      var $self = $(this);
      var data = $self.data();
      new Chartabull($self, data.values, data.options, data.text);
    });
  })();
</script>
